<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Realistic Telegram App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');

        :root { --bg-color: #000000; }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-color);
            height: 100vh; width: 100vw; overflow: hidden;
            display: flex; flex-direction: column; align-items: center;
            color: white; user-select: none; -webkit-tap-highlight-color: transparent;
        }

        /* --- LOADING SCREEN --- */
        .app-loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 9999;
            display: flex; justify-content: center; align-items: center;
            transition: opacity 0.4s ease, visibility 0.4s;
        }
        .spinner {
            width: 45px; height: 45px;
            border: 4px solid rgba(255,255,255,0.1); border-top: 4px solid #fff;
            border-radius: 50%; animation: spin 0.8s linear infinite;
        }
        @keyframes spin { 100% { transform: rotate(360deg); } }
        .app-loader.hidden { opacity: 0; visibility: hidden; }

        /* --- HEADER --- */
        .app-header {
            position: fixed; top: 0; left: 0; width: 100%;
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px 20px; z-index: 100;
        }
        .header-left {
            display: flex; align-items: center; gap: 15px;
            transform: translateX(-20px); opacity: 0; transition: all 0.5s ease;
        }

        /* Timer Icon (Simple) */
        .timer-icon { width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; }
        .timer-icon svg { width: 100%; height: 100%; fill: none; stroke: white; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }

        /* Profile Pill */
        .profile-pill {
            display: flex; align-items: center;
            background: rgba(40, 40, 40, 0.7); backdrop-filter: blur(12px);
            padding: 4px 14px 4px 4px; border-radius: 50px;
            border: 1px solid rgba(255, 255, 255, 0.15); height: 38px;
            transition: transform 0.2s;
        }
        .profile-pill:active { transform: scale(0.97); }
        .profile-img { width: 30px; height: 30px; border-radius: 50%; object-fit: cover; margin-right: 10px; background-color: #2a2a2a; display: block; }
        .profile-initials { width: 30px; height: 30px; border-radius: 50%; margin-right: 10px; background: linear-gradient(135deg, #8E2DE2, #4A00E0); display: flex; justify-content: center; align-items: center; font-weight: 600; font-size: 14px; color: white; text-transform: uppercase; }
        .profile-name { font-size: 14px; font-weight: 500; color: #fff; letter-spacing: 0.3px; }

        /* Menu Button */
        .menu-btn {
            width: 42px; height: 42px; background: rgba(255, 255, 255, 0.1); border-radius: 12px;
            backdrop-filter: blur(10px); display: flex; flex-direction: column;
            justify-content: center; align-items: center; gap: 5px; cursor: pointer;
            border: 1px solid rgba(255,255,255,0.05); transform: translateX(20px); opacity: 0; transition: all 0.5s ease;
        }
        .menu-line { width: 20px; height: 2px; background-color: white; border-radius: 2px; }
        .menu-btn:active { transform: scale(0.95); background: rgba(255,255,255,0.2); }

        /* --- BACKGROUND --- */
        .main-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; }
        .orb { position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.6; animation: float 8s infinite alternate; }
        .orb-1 { top: 10%; left: 10%; width: 60vw; height: 60vw; background: #2563eb; }
        .orb-2 { bottom: 10%; right: 10%; width: 50vw; height: 50vw; background: #db2777; animation-delay: -3s; }
        @keyframes float { 0% { transform: translate(0,0); } 100% { transform: translate(20px, -20px); } }

        .glass-card {
            width: 300px; height: 350px; background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.1); border-radius: 24px;
            backdrop-filter: blur(20px); display: flex; justify-content: center; align-items: center;
            color: rgba(255,255,255,0.3); position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
        }

        /* --- BOTTOM SHEET --- */
        .bottom-sheet {
            position: fixed; bottom: 0; left: 0; width: 100%;
            height: 75vh; /* TALLER HEIGHT (75%) */
            background: #121212; border-radius: 30px 30px 0 0;
            transform: translateY(110%);
            /* Smooth transitions handled by JS for swipe, but CSS for toggle */
            z-index: 200; box-shadow: 0 -10px 40px rgba(0,0,0,0.6);
            border-top: 1px solid rgba(255,255,255,0.1);
            padding-bottom: 30px;
            display: flex; flex-direction: column;
        }
        
        .drag-area {
            width: 100%; height: 40px;
            display: flex; justify-content: center; align-items: center;
            flex-shrink: 0; /* Prevent shrinking */
            cursor: grab;
        }
        .drag-handle { width: 50px; height: 5px; background: rgba(255,255,255,0.3); border-radius: 10px; }

        .sheet-content { 
            padding: 10px 20px 30px 20px; 
            flex-grow: 1; 
            overflow-y: auto; /* Scrollable if needed */
        }
        
        .sheet-title { font-size: 1.4rem; font-weight: 600; margin-bottom: 25px; color: #fff; padding-left: 5px; }

        /* --- GRID LAYOUT --- */
        .menu-grid {
            display: grid; grid-template-columns: 1fr 1fr; gap: 15px;
        }

        .menu-item {
            position: relative;
            background: rgba(30, 30, 30, 0.5); /* Semi-transparent base */
            border-radius: 20px; padding: 20px;
            height: 140px; /* Bigger Boxes */
            display: flex; flex-direction: column; justify-content: space-between;
            border: 1px solid rgba(255,255,255,0.08);
            overflow: hidden; /* For inner motion */
            transition: transform 0.1s;
        }
        .menu-item:active { transform: scale(0.97); }

        /* MOTION BG INSIDE BOXES */
        .box-bg-anim {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 0; opacity: 0.4;
        }
        .box-blob {
            position: absolute; width: 100px; height: 100px; border-radius: 50%;
            filter: blur(40px); animation: boxFloat 5s infinite alternate;
        }
        /* Different colors for boxes */
        .box-1 .box-blob { background: #4f46e5; top: -20%; right: -20%; }
        .box-2 .box-blob { background: #db2777; bottom: -20%; left: -20%; }
        .box-3 .box-blob { background: #0ea5e9; top: 40%; left: 40%; }
        .box-4 .box-blob { background: #eab308; top: -10%; left: -10%; }

        @keyframes boxFloat { 0% { transform: translate(0,0); } 100% { transform: translate(10px, 10px); } }

        /* Box Content */
        .item-text { position: relative; z-index: 1; }
        .item-text h3 { font-size: 17px; font-weight: 600; color: #fff; margin-bottom: 5px; }
        .item-text p { font-size: 12px; color: #aaa; line-height: 1.3; }

        .item-icon {
            position: relative; z-index: 1; align-self: flex-end;
            width: 40px; height: 40px;
            display: flex; justify-content: center; align-items: center;
            background: rgba(255,255,255,0.1); border-radius: 12px;
            backdrop-filter: blur(5px);
        }
        .item-icon svg { width: 24px; height: 24px; fill: white; }

        .overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7); backdrop-filter: blur(3px);
            z-index: 150; opacity: 0; pointer-events: none; transition: opacity 0.3s;
        }
        .overlay.active { opacity: 1; pointer-events: auto; }

    </style>
</head>
<body>

    <div class="app-loader" id="appLoader">
        <div class="spinner"></div>
    </div>

    <div class="main-bg">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
    </div>

    <header class="app-header">
        <div class="header-left" id="headerLeft">
            <div class="timer-icon">
                <svg viewBox="0 0 24 24">
                    <circle cx="12" cy="13" r="9" />
                    <path d="M12 4V2" /> <path d="M10 2H14" />
                    <path d="M12 13V8" /> <path d="M12 13L15 15" />
                </svg>
            </div>
            <div class="profile-pill">
                <img src="" id="userAvatar" class="profile-img" style="display: none;">
                <div id="userInitials" class="profile-initials" style="display: none;">?</div>
                <span id="userName" class="profile-name">User</span>
            </div>
        </div>
        <div class="menu-btn" id="menuBtn">
            <div class="menu-line"></div>
            <div class="menu-line"></div>
            <div class="menu-line"></div>
        </div>
    </header>

    <div class="glass-card">MAIN CONTENT</div>

    <div class="overlay" id="overlay"></div>

    <div class="bottom-sheet" id="bottomSheet">
        <div class="drag-area" id="dragArea">
            <div class="drag-handle"></div>
        </div>

        <div class="sheet-content">
            <div class="sheet-title">Menu</div>
            
            <div class="menu-grid">
                
                <div class="menu-item box-1">
                    <div class="box-bg-anim"><div class="box-blob"></div></div>
                    <div class="item-text">
                        <h3>Support</h3>
                        <p>We're here to help</p>
                    </div>
                    <div class="item-icon">
                        <svg viewBox="0 0 24 24"><path d="M21 12.22C21 6.88 16.74 2.67 11.5 3.02C6.96 3.33 3.23 7.03 3.01 11.55C2.76 16.8 6.94 21 12 21H13V15H11C9.34 15 8 13.66 8 12V10H6V12C6 15.31 8.69 18 12 18H13V21H12C7.03 21 3 16.97 3 12C3 7.03 7.03 3 12 3C16.97 3 21 7.03 21 12V13H19V12.22H21ZM19 15H16V21H19V15ZM19 13C20.1 13 21 13.9 21 15V21H15V13H19Z"/></svg>
                    </div>
                </div>

                <div class="menu-item box-2">
                    <div class="box-bg-anim"><div class="box-blob" style="background: #ec4899;"></div></div>
                    <div class="item-text">
                        <h3>Channel</h3>
                        <p>Latest updates</p>
                    </div>
                    <div class="item-icon">
                        <svg viewBox="0 0 24 24"><path d="M4 9V15H8L13 20V4L8 9H4ZM16.5 12C16.5 10.23 15.48 8.71 14 7.97V16.02C15.48 15.29 16.5 13.77 16.5 12ZM14 3.23V5.29C16.89 6.15 19 8.83 19 12C19 15.17 16.89 17.85 14 18.71V20.77C18.01 19.86 21 16.28 21 12C21 7.72 18.01 4.14 14 3.23Z"/></svg>
                    </div>
                </div>

                <div class="menu-item box-3">
                    <div class="box-bg-anim"><div class="box-blob" style="background: #3b82f6;"></div></div>
                    <div class="item-text">
                        <h3>Portal</h3>
                        <p>Gateway access</p>
                    </div>
                    <div class="item-icon">
                        <svg viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="10" stroke="white" fill="none" stroke-width="2"/>
                            <path d="M2 12H22" stroke="white" stroke-width="2"/>
                            <path d="M12 2C14.5 2 16.5 6.5 16.5 12C16.5 17.5 14.5 22 12 22C9.5 22 7.5 17.5 7.5 12C7.5 6.5 9.5 2 12 2Z" stroke="white" fill="none" stroke-width="2"/>
                            <path d="M4 7H20" stroke="white" stroke-width="2"/>
                            <path d="M4 17H20" stroke="white" stroke-width="2"/>
                        </svg>
                    </div>
                </div>

                <div class="menu-item box-4">
                    <div class="box-bg-anim"><div class="box-blob" style="background: #eab308;"></div></div>
                    <div class="item-text">
                        <h3>Vouch</h3>
                        <p>Verified reviews</p>
                    </div>
                    <div class="item-icon">
                        <svg viewBox="0 0 24 24"><path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2ZM12 15.4L14.05 16.47L13.5 14.24L15.22 12.63L12.87 12.31L12 10.22L11.13 12.31L8.78 12.63L10.5 14.24L9.95 16.47L12 15.4Z"/></svg>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready(); tg.expand();

        const appLoader = document.getElementById('appLoader');
        const headerLeft = document.getElementById('headerLeft');
        const menuBtn = document.getElementById('menuBtn');
        const bottomSheet = document.getElementById('bottomSheet');
        const dragArea = document.getElementById('dragArea');
        const overlay = document.getElementById('overlay');
        const userNameEl = document.getElementById('userName');
        const userAvatarEl = document.getElementById('userAvatar');
        const userInitialsEl = document.getElementById('userInitials');

        // --- 1. REALISTIC LOADING (0.5s) ---
        window.onload = function() {
            setTimeout(() => {
                appLoader.classList.add('hidden');
                setTimeout(() => {
                    headerLeft.style.opacity = '1';
                    headerLeft.style.transform = 'translateX(0)';
                    menuBtn.style.opacity = '1';
                    menuBtn.style.transform = 'translateX(0)';
                    appLoader.style.display = 'none';
                }, 200);
            }, 500);
        };

        // --- 2. USER DATA ---
        if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
            const user = tg.initDataUnsafe.user;
            userNameEl.innerText = user.first_name;
            if (user.photo_url) {
                userAvatarEl.src = user.photo_url;
                userAvatarEl.style.display = 'block';
                userInitialsEl.style.display = 'none';
            } else {
                const initial = user.first_name.charAt(0).toUpperCase();
                userInitialsEl.innerText = initial;
                userInitialsEl.style.display = 'flex';
                userAvatarEl.style.display = 'none';
            }
        }

        // --- 3. MENU OPEN/CLOSE ---
        function openMenu() {
            bottomSheet.style.transition = 'transform 0.4s cubic-bezier(0.2, 0.8, 0.2, 1)';
            bottomSheet.style.transform = 'translateY(0)';
            overlay.classList.add('active');
        }

        function closeMenu() {
            bottomSheet.style.transition = 'transform 0.4s cubic-bezier(0.2, 0.8, 0.2, 1)';
            bottomSheet.style.transform = 'translateY(110%)';
            overlay.classList.remove('active');
        }

        // --- 4. SWIPE TO CLOSE LOGIC (REALISTIC) ---
        let startY = 0;
        let currentY = 0;
        let isDragging = false;

        // Attach touch events to the Drag Area (Header of Sheet)
        // You can attach to bottomSheet if you want whole area draggable, 
        // but Drag Area is better to allow scrolling inside content.
        bottomSheet.addEventListener('touchstart', (e) => {
            // Only drag if we are at the top of scroll
            if (bottomSheet.scrollTop === 0) {
                startY = e.touches[0].clientY;
                isDragging = true;
                bottomSheet.style.transition = 'none'; // Disable transition for direct tracking
            }
        }, { passive: true });

        bottomSheet.addEventListener('touchmove', (e) => {
            if (!isDragging) return;
            currentY = e.touches[0].clientY;
            let diff = currentY - startY;

            // Only allow dragging DOWN (positive diff)
            if (diff > 0) {
                e.preventDefault(); // Stop scrolling
                bottomSheet.style.transform = `translateY(${diff}px)`;
            }
        }, { passive: false });

        bottomSheet.addEventListener('touchend', (e) => {
            if (!isDragging) return;
            isDragging = false;
            let diff = currentY - startY;

            if (diff > 100) {
                // If dragged down more than 100px, close it
                closeMenu();
            } else {
                // Bounce back up
                openMenu(); 
            }
            // Reset variables
            startY = 0; currentY = 0;
        });

        // Click Events
        menuBtn.addEventListener('click', openMenu);
        overlay.addEventListener('click', closeMenu);

    </script>
</body>
</html>
